<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLSP Run & Rise Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0EA5E9, #10B981, #F59E0B, #EF4444);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .logo {
            margin-bottom: 20px;
        }
        
        .main-title {
            font-size: 2.8em;
            font-weight: bold;
            background: linear-gradient(45deg, #0EA5E9, #10B981, #F59E0B, #EF4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: #10B981;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .slogan {
            font-size: 1em;
            color: #1E40AF;
            font-style: italic;
        }
        
        .attribution {
            font-size: 0.9em;
            color: #8B5CF6;
            margin-top: 5px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }
        
        .stat-card {
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card.start {
            background: linear-gradient(135deg, #0EA5E9, #0284C7);
        }
        
        .stat-card.love {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .stat-card.support {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }
        
        .stat-icon {
            font-size: 2em;
            margin-bottom: 15px;
        }
        
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .stat-label {
            opacity: 0.9;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .stat-subtitle {
            opacity: 0.7;
            font-size: 0.9em;
        }
        
        .erste-route-section {
            background: white;
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .route-title {
            text-align: center;
            font-size: 2em;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #0EA5E9, #10B981, #F59E0B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .route-subtitle {
            text-align: center;
            color: #6B7280;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .route-map-container {
            position: relative;
            background: #F9FAFB;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .map-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
            display: block;
        }
        
        .map-overlay {
            position: absolute;
            top: 30px;
            left: 30px;
            right: 30px;
            bottom: 30px;
            pointer-events: none;
        }
        
        .city-marker {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            pointer-events: all;
            transition: transform 0.3s ease;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .city-marker:hover {
            transform: scale(1.3);
            z-index: 10;
        }
        
        .city-marker.completed {
            background: #10B981;
        }
        
        .city-marker.current {
            background: #F59E0B;
            animation: pulse 2s infinite;
        }
        
        .city-marker.locked {
            background: #9CA3AF;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.15); opacity: 0.8; }
        }
        
        .city-info-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            z-index: 1000;
            display: none;
            border: 3px solid #0EA5E9;
        }
        
        .city-info-popup.show {
            display: block;
        }
        
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        
        .popup-overlay.show {
            display: block;
        }
        
        .city-info-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1F2937;
        }
        
        .city-info-section {
            margin-bottom: 15px;
        }
        
        .city-info-label {
            font-weight: 600;
            color: #0EA5E9;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .city-info-text {
            color: #4B5563;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        .close-popup {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #6B7280;
        }
        
        .close-popup:hover {
            color: #1F2937;
        }
        
        .route-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
            text-align: center;
        }
        
        .route-stat {
            background: #F9FAFB;
            padding: 20px;
            border-radius: 12px;
        }
        
        .route-stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #0EA5E9;
        }
        
        .route-stat-label {
            color: #6B7280;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .current-location {
            background: #FEF3C7;
            border: 2px solid #F59E0B;
            padding: 20px;
            border-radius: 12px;
            margin: 30px 0;
            text-align: center;
        }
        
        .current-location-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #92400E;
            margin-bottom: 10px;
        }
        
        .current-location-text {
            color: #78350F;
            font-size: 1.1em;
        }
        
        .next-checkpoint {
            background: #DBEAFE;
            border: 2px solid #0EA5E9;
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
        }
        
        .next-checkpoint-title {
            font-weight: bold;
            color: #075985;
            margin-bottom: 5px;
        }
        
        .next-checkpoint-km {
            color: #0369A1;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .city-card {
            background: #F9FAFB;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .city-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .city-card.completed {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            border-color: #10B981;
        }
        
        .city-card.current {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            border-color: #F59E0B;
            animation: cardPulse 2s infinite;
        }
        
        @keyframes cardPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        .city-card.locked {
            opacity: 0.5;
        }
        
        .city-flag {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .city-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .city-distance {
            font-size: 0.85em;
            opacity: 0.8;
        }
        
        .city-status {
            margin-top: 10px;
            font-size: 1.2em;
        }
        
        .admin-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px dashed #dee2e6;
        }
        
        .admin-toggle {
            background: #6B7280;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .admin-toggle:hover {
            background: #4B5563;
        }
        
        .admin-login {
            display: none;
        }
        
        .admin-login.active {
            display: block;
        }
        
        .admin-form {
            display: none;
        }
        
        .admin-form.active {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }
        
        .form-group input {
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .update-btn {
            background: #10B981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .update-btn:hover {
            background: #059669;
        }
        
        .login-btn {
            background: #0EA5E9;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .login-btn:hover {
            background: #0284C7;
        }
        
        .error-message {
            color: #DC2626;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .last-updated {
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 20px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .main-title {
                font-size: 2.2em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .route-stats {
                grid-template-columns: 1fr;
            }
            
            .cities-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-form {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üèÉ‚Äç‚ôÇÔ∏è</div>
            <h1 class="main-title">SLSP Run & Rise</h1>
            <p class="subtitle">Start. Love. Support. Purpose.</p>
            <p class="slogan">"Zaƒçni s nami a be≈æ za bud√∫cnos≈•"</p>
            <p class="attribution">Iniciat√≠va Women's Voices</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card start">
                <div class="stat-icon">‚ñ∂Ô∏è</div>
                <div class="stat-number" id="totalRunners">0</div>
                <div class="stat-label">START</div>
                <div class="stat-subtitle">Akt√≠vnych be≈æcov</div>
            </div>
            
            <div class="stat-card love">
                <div class="stat-icon">‚ù§Ô∏è</div>
                <div class="stat-number" id="totalKm">0</div>
                <div class="stat-label">LOVE</div>
                <div class="stat-subtitle">Nabehan√© kilometre</div>
            </div>
            
            <div class="stat-card support">
                <div class="stat-icon">ü§ù</div>
                <div class="stat-number" id="totalEuro">0‚Ç¨</div>
                <div class="stat-label">SUPPORT</div>
                <div class="stat-subtitle">Pre dobr√∫ vec</div>
            </div>
        </div>
        
        <div class="erste-route-section">
            <h2 class="route-title">üó∫Ô∏è Erste Group Journey</h2>
            <p class="route-subtitle">Bratislava ‚Üí Budape≈°≈• ‚Üí Bukure≈°≈• ‚Üí Belehrad ‚Üí Z√°hreb ‚Üí Viede≈à ‚Üí Praha ‚Üí Ko≈°ice ‚Üí Bratislava</p>
            
            <div class="route-stats">
                <div class="route-stat">
                    <div class="route-stat-number" id="routeKm">0 km</div>
                    <div class="route-stat-label">Nabehan√© km</div>
                </div>
                <div class="route-stat">
                    <div class="route-stat-number" id="routePercent">0%</div>
                    <div class="route-stat-label">Cesty dokonƒçen√©</div>
                </div>
                <div class="route-stat">
                    <div class="route-stat-number" id="routeCities">0/8</div>
                    <div class="route-stat-label">Nav≈°t√≠ven√© mest√°</div>
                </div>
            </div>
            
            <div class="current-location" id="currentLocation">
                <div class="current-location-title">üìç Aktu√°lna poz√≠cia</div>
                <div class="current-location-text" id="currentLocationText">≈†tart v Bratislave</div>
                
                <div class="next-checkpoint" id="nextCheckpoint">
                    <div class="next-checkpoint-title">ƒéal≈°√≠ checkpoint:</div>
                    <div class="next-checkpoint-km" id="nextCheckpointText">üá≠üá∫ Budape≈°≈• - 200 km</div>
                </div>
            </div>
            
            <div class="route-map-container" id="mapContainer">
                <img src="map.png" alt="Erste Route Map" class="map-image" id="routeMapImage">
                <div class="map-overlay" id="mapOverlay"></div>
            </div>
            
            <div class="cities-grid" id="citiesGrid"></div>
        </div>
        
        <!-- Admin panel -->
        <div class="admin-panel">
            <button class="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è Aktualizova≈• √∫daje</button>
            
            <div class="admin-login" id="adminLogin">
                <div class="form-group">
                    <label>Heslo:</label>
                    <input type="password" id="adminPassword" placeholder="Zadaj heslo">
                </div>
                <div class="form-group">
                    <button class="login-btn" onclick="checkPassword()">Prihl√°si≈•</button>
                </div>
                <div class="error-message" id="errorMessage"></div>
            </div>
            
            <div class="admin-form" id="adminForm">
                <div class="form-group">
                    <label>Poƒçet be≈æcov</label>
                    <input type="number" id="inputRunners" min="0">
                </div>
                
                <div class="form-group">
                    <label>Celkov√© km</label>
                    <input type="number" id="inputKm" step="0.1" min="0">
                </div>
                
                <div class="form-group">
                    <button class="update-btn" onclick="updateData()">Aktualizova≈•</button>
                </div>
            </div>
        </div>
        
        <div class="last-updated" id="lastUpdated">
            Posledn√° aktualiz√°cia: Nikdy
        </div>
    </div>
    
    <!-- Popup overlay -->
    <div class="popup-overlay" id="popupOverlay" onclick="closePopup()"></div>
    
    <!-- City info popup -->
    <div class="city-info-popup" id="cityInfoPopup">
        <span class="close-popup" onclick="closePopup()">√ó</span>
        <div id="popupContent"></div>
    </div>

    <script>
        // Password protection
        const ADMIN_PASSWORD = 'slsprun_2026';
        let isAuthenticated = false;
        
        // Erste Group Route
        const ersteRoute = [
            { 
                city: "Bratislava", 
                country: "Slovensko", 
                flag: "üá∏üá∞", 
                km: 0,
                mapX: 30,
                mapY: 38,
                runFact: "Bratislavsk√Ω marat√≥n je najstar≈°√≠ na Slovensku (od 2006)",
                ersteFact: "Slovensk√° sporiteƒæ≈àa je s√∫ƒças≈•ou Erste Group od roku 2001"
            },
            { 
                city: "Budape≈°≈•", 
                country: "Maƒèarsko", 
                flag: "üá≠üá∫", 
                km: 200,
                mapX: 38,
                mapY: 50,
                runFact: "Budape≈°tianksy marat√≥n vedie popri Dunaji s v√Ωhƒæadom na parlament",
                ersteFact: "Erste Bank Hungary p√¥sob√≠ v krajine od roku 1997"
            },
            { 
                city: "Bukure≈°≈•", 
                country: "Rumunsko", 
                flag: "üá∑üá¥", 
                km: 1040,
                mapX: 88,
                mapY: 92,
                runFact: "Bukure≈°≈•sk√Ω polmarat√≥n je jeden z najr√Ωchlej≈°ie rast√∫cich behov v regi√≥ne",
                ersteFact: "Banca ComercialƒÉ Rom√¢nƒÉ je najv√§ƒç≈°ia banka v Rumunsku"
            },
            { 
                city: "Belehrad", 
                country: "Srbsko", 
                flag: "üá∑üá∏", 
                km: 1670,
                mapX: 50,
                mapY: 84,
                runFact: "Belehradsk√Ω marat√≥n prech√°dza cez historick√© pevnosti",
                ersteFact: "Erste Bank Serbia podporuje digit√°lne bankovn√≠ctvo od roku 2005"
            },
            { 
                city: "Z√°hreb", 
                country: "Chorv√°tsko", 
                flag: "üá≠üá∑", 
                km: 2070,
                mapX: 18,
                mapY: 72,
                runFact: "Z√°hrebsk√Ω marat√≥n vedie cez malebn√© parky a historick√© centrum",
                ersteFact: "Erste&Steierm√§rkische Bank p√¥sob√≠ v Chorv√°tsku od roku 2003"
            },
            { 
                city: "Viede≈à", 
                country: "Rak√∫sko", 
                flag: "üá¶üáπ", 
                km: 2450,
                mapX: 22,
                mapY: 38,
                runFact: "Viedensk√Ω mestsk√Ω marat√≥n je jeden z najr√Ωchlej≈°√≠ch v Eur√≥pe",
                ersteFact: "Erste Group m√° s√≠dlo vo Viedni a p√¥sob√≠ od roku 1819"
            },
            { 
                city: "Praha", 
                country: "ƒåesko", 
                flag: "üá®üáø", 
                km: 2780,
                mapX: 8,
                mapY: 10,
                runFact: "Pra≈æsk√Ω marat√≥n je pova≈æovan√Ω za jeden z najkraj≈°√≠ch v Eur√≥pe",
                ersteFact: "ƒåesk√° spo≈ôitelna je l√≠drom digit√°lneho bankovn√≠ctva v ƒåR"
            },
            { 
                city: "Ko≈°ice", 
                country: "Slovensko", 
                flag: "üá∏üá∞", 
                km: 3210,
                mapX: 58,
                mapY: 32,
                runFact: "Ko≈°ick√Ω Medzin√°rodn√Ω marat√≥n mieru je najstar≈°√≠ v Eur√≥pe (od 1924)",
                ersteFact: "V√Ωchodoslovensk√° poboƒçkov√° s√≠≈• patr√≠ medzi najsilnej≈°ie v SK"
            },
            { 
                city: "Bratislava", 
                country: "Slovensko", 
                flag: "üá∏üá∞", 
                km: 3610,
                mapX: 30,
                mapY: 38,
                runFact: "Dokonƒçili sme okruh! üéâ Brav√≥!",
                ersteFact: "Sp√§≈• v centr√°le Slovenskej sporiteƒæne"
            }
        ];
        
        const totalRouteKm = 3610;
        
        // Data storage
        let data = JSON.parse(localStorage.getItem('slspRunRiseData') || JSON.stringify({
            runners: 0,
            kilometers: 0,
            lastUpdated: null
        }));
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            loadFormData();
        });
        
        function toggleAdmin() {
            const login = document.getElementById('adminLogin');
            const form = document.getElementById('adminForm');
            
            if (isAuthenticated) {
                form.classList.toggle('active');
                login.classList.remove('active');
            } else {
                login.classList.toggle('active');
                form.classList.remove('active');
            }
        }
        
        function checkPassword() {
            const password = document.getElementById('adminPassword').value;
            const errorMsg = document.getElementById('errorMessage');
            
            if (password === ADMIN_PASSWORD) {
                isAuthenticated = true;
                document.getElementById('adminLogin').classList.remove('active');
                document.getElementById('adminForm').classList.add('active');
                document.getElementById('adminPassword').value = '';
                errorMsg.textContent = '';
            } else {
                errorMsg.textContent = '‚ùå Nespr√°vne heslo!';
                setTimeout(() => {
                    errorMsg.textContent = '';
                }, 3000);
            }
        }
        
        function loadFormData() {
            document.getElementById('inputRunners').value = data.runners;
            document.getElementById('inputKm').value = data.kilometers;
        }
        
        function updateData() {
            data.runners = parseInt(document.getElementById('inputRunners').value) || 0;
            data.kilometers = parseFloat(document.getElementById('inputKm').value) || 0;
            data.lastUpdated = new Date().toISOString();
            
            localStorage.setItem('slspRunRiseData', JSON.stringify(data));
            
            updateDisplay();
            
            document.getElementById('adminForm').classList.remove('active');
            
            alert('‚úÖ √ödaje boli √∫spe≈°ne aktualizovan√©!');
        }
        
        function updateDisplay() {
            // Update main stats
            document.getElementById('totalRunners').textContent = data.runners;
            document.getElementById('totalKm').textContent = data.kilometers.toFixed(1);
            
            const totalEuro = Math.floor(data.kilometers);
            document.getElementById('totalEuro').textContent = totalEuro + '‚Ç¨';
            
            // Update route
            updateErsteRoute();
            
            // Last updated
            const lastUpdatedElement = document.getElementById('lastUpdated');
            if (data.lastUpdated) {
                const date = new Date(data.lastUpdated);
                lastUpdatedElement.textContent = `Posledn√° aktualiz√°cia: ${date.toLocaleDateString('sk-SK')} o ${date.toLocaleTimeString('sk-SK')}`;
            }
        }
        
        function updateErsteRoute() {
            const currentKm = data.kilometers;
            const progressPercent = Math.min((currentKm / totalRouteKm) * 100, 100);
            
            document.getElementById('routeKm').textContent = currentKm.toFixed(1) + ' km';
            document.getElementById('routePercent').textContent = progressPercent.toFixed(1) + '%';
            
            // Find current position
            let currentCityIndex = 0;
            let visitedCities = 0;
            
            for (let i = 0; i < ersteRoute.length; i++) {
                if (currentKm >= ersteRoute[i].km) {
                    currentCityIndex = i;
                    if (i < ersteRoute.length - 1) visitedCities = i + 1;
                    else visitedCities = 8;
                }
            }
            
            document.getElementById('routeCities').textContent = Math.min(visitedCities, 8) + '/8';
            
            // Update map markers
            updateMapMarkers(currentKm, currentCityIndex);
            
            // Update current location
            const currentCity = ersteRoute[currentCityIndex];
            const nextCity = ersteRoute[currentCityIndex + 1];
            
            if (currentKm >= totalRouteKm) {
                document.getElementById('currentLocationText').textContent = 'üéâ Okruh dokonƒçen√Ω! Gratulujeme!';
                document.getElementById('nextCheckpoint').style.display = 'none';
            } else if (nextCity) {
                const kmToNext = nextCity.km - currentKm;
                document.getElementById('currentLocationText').textContent = 
                    `Na ceste medzi ${currentCity.flag} ${currentCity.city} a ${nextCity.flag} ${nextCity.city}`;
                document.getElementById('nextCheckpointText').textContent = 
                    `${nextCity.flag} ${nextCity.city} - e≈°te ${kmToNext.toFixed(1)} km`;
            }
            
            // Update cities grid
            const uniqueCities = ersteRoute.slice(0, -1);
            const citiesGrid = document.getElementById('citiesGrid');
            citiesGrid.innerHTML = uniqueCities.map((city, index) => {
                let status = 'locked';
                let statusIcon = 'üîí';
                
                if (currentKm >= city.km) {
                    status = 'completed';
                    statusIcon = '‚úÖ';
                } else {
                    const nextTarget = ersteRoute.find(c => c.km > currentKm);
                    if (nextTarget && nextTarget.city === city.city && nextTarget.km === city.km) {
                        status = 'current';
                        statusIcon = 'üéØ';
                    }
                }
                
                return `
                    <div class="city-card ${status}" onclick="showCityInfo(${index})">
                        <div class="city-flag">${city.flag}</div>
                        <div class="city-name">${city.city}</div>
                        <div class="city-distance">${city.km} km</div>
                        <div class="city-status">${statusIcon}</div>
                    </div>
                `;
            }).join('');
        }
        
        function updateMapMarkers(currentKm, currentCityIndex) {
            const overlay = document.getElementById('mapOverlay');
            overlay.innerHTML = '';
            
            ersteRoute.slice(0, -1).forEach((city, index) => {
                let markerClass = 'locked';
                
                if (currentKm >= city.km) {
                    markerClass = 'completed';
                } else if (index === currentCityIndex + 1) {
                    markerClass = 'current';
                }
                
                const marker = document.createElement('div');
                marker.className = `city-marker ${markerClass}`;
                marker.style.left = city.mapX + '%';
                marker.style.top = city.mapY + '%';
                marker.innerHTML = city.flag;
                marker.onclick = () => showCityInfo(index);
                
                overlay.appendChild(marker);
            });
        }
        
        function showCityInfo(index) {
            const city = ersteRoute[index];
            const popup = document.getElementById('cityInfoPopup');
            const overlay = document.getElementById('popupOverlay');
            
            document.getElementById('popupContent').innerHTML = `
                <div class="city-info-title">${city.flag} ${city.city}, ${city.country}</div>
                <div class="city-info-section">
                    <div class="city-info-label">üèÉ‚Äç‚ôÇÔ∏è Be≈æeck√Ω fakt:</div>
                    <div class="city-info-text">${city.runFact}</div>
                </div>
                <div class="city-info-section">
                    <div class="city-info-label">üè¶ Erste Bank fakt:</div>
                    <div class="city-info-text">${city.ersteFact}</div>
                </div>
                <div class="city-info-section">
                    <div class="city-info-label">üìç Vzdialenos≈• od ≈°tartu:</div>
                    <div class="city-info-text">${city.km} km</div>
                </div>
            `;
            
            popup.classList.add('show');
            overlay.classList.add('show');
        }
        
        function closePopup() {
            document.getElementById('cityInfoPopup').classList.remove('show');
            document.getElementById('popupOverlay').classList.remove('show');
        }
        
        // Animation on load
        setTimeout(() => {
            if (data.runners > 0 || data.kilometers > 0) {
                animateNumbers();
            }
        }, 500);
        
        function animateNumbers() {
            animateValue('totalRunners', 0, data.runners, 1500);
            animateValue('totalKm', 0, data.kilometers, 1500, true);
        }
        
        function animateValue(id, start, end, duration, isDecimal = false) {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                
                if (isDecimal) {
                    element.textContent = current.toFixed(1);
                } else if (id === 'totalEuro') {
                    element.textContent = Math.floor(current) + '‚Ç¨';
                } else {
                    element.textContent = Math.floor(current);
                }
            }, 16);
        }
        
        // Allow Enter key for password
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('adminLogin').classList.contains('active')) {
                checkPassword();
            }
        });
    </script>
</body>
</html>